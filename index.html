<<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>

    <style>
#zombie_map {
    height: 100%;
    width: 100%;
    left: 0;
    position: absolute;
    top: 0;
    background-color: grey;
}
</style>

  </head>
  <body>

    My zombie map
<div id="zombie_map"></div>
<script>
    var zombie_map;
    var score;
    var tolerance = 10;
    var old_position;
    var all_markers = [];
    var data = `49.81525246778927 -97.10616874468445 eggs.png
49.81533727235806 -97.10592198145508 eggs.png
49.81541169257151 -97.10570472252488 eggs.png
49.81548611267053 -97.10545259487748 eggs.png
49.815574378220965 -97.10523533594727 eggs.png
49.81564879806979 -97.10500466597199 eggs.png
49.81572840987438 -97.10473912727952 eggs.png
49.81576994641607 -97.10444676649689 eggs.png
49.81576821572755 -97.10416513455033 eggs.png
49.815763023661624 -97.1038888670218 eggs.png
49.81575783159511 -97.10361259949326 eggs.png
49.81575610090614 -97.103384611727 eggs.png
49.81574744746042 -97.1031324840796 eggs.png`;

// Split the data into an array of lines of data
var markers = data.split("\n");

// Save the locations of all markers
var all_markers = [];

    function initMap() {
      // SET YOUR OWN CENTER OF THE MAP
      zombie_map = new google.maps.Map(document.getElementById('zombie_map'), {
        zoom: 12,
        center: {lat: 49.895491, lng: -97.138463 }
        });

        // Get geolocation
        if( navigator.geolocation) {
            navigator.geolocation.watchPosition(set_my_position);
        }
        else {
            alert("Geolocation doesn't work in your browser");
        }

        // Add markers
        for(var i=0; i < markers.length; i++){

            // Split this marker's info into an array
            var marker_data = markers[i].trim().split(" ");

            // Create the LatLng of the marker
            var marker_position = new google.maps.LatLng(marker_data[0], marker_data[1]);

            // Create a marker at this point
            var marker = new google.maps.Marker({
              position: marker_position,
              icon: marker_data[2],
              map: zombie_map
            });
            // Add this marker to the list
            all_markers.push(marker);
        }

        console.log(all_markers);

        // SET YOUR OWN OLD POSITION (same as map center)
        old_position = new google.maps.Marker({
            position: {lat: 0, lng: 0},
            map: zombie_map
        })
    }

    function set_my_position(position){
        old_position.setMap(null);
        var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        var marker = new google.maps.Marker({
          position: pos,
          icon: "bunny.png",
          map: zombie_map
        });
        old_position = marker;
        for(var i=0; i < all_markers.length; i++){
            var distance = google.maps.geometry.spherical.computeDistanceBetween(pos, all_markers[i].getPosition());
            if( distance < tolerance ){
                console.log("Found it!")
            }
        }
    }
  </script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAKuA0TkNGo5mov8QWSI0WYcOHKo_NCOpw&callback=initMap&libraries=geometry">
</script>
  </body>
</html>
